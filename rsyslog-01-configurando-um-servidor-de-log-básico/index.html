<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=author content="K."> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Rsyslog #01: Configurando um Servidor de Log Básico | K.</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Rsyslog #01: Configurando um Servidor de Log Básico" /> <meta name="author" content="keven" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Tive a oportunidade de trabalhar com Rsyslog por um bom tempo, auxiliando na centralização dos logs de servidores. Isso me permitiu ver a necessidade de termos logs centralizado, bem como o quão importante eles são para um sistema. Neste artigo, tenho como objetivo ensinar a como configurar um servidor de log básico utilizando a ferramenta Rsyslog e introduzir um pouco sobre Facilidade e Nível. Essa será uma série de artigos, sendo este o primeiro. Os demais, serão mais específicos da ferramenta. Espero que gostem!" /> <meta property="og:description" content="Tive a oportunidade de trabalhar com Rsyslog por um bom tempo, auxiliando na centralização dos logs de servidores. Isso me permitiu ver a necessidade de termos logs centralizado, bem como o quão importante eles são para um sistema. Neste artigo, tenho como objetivo ensinar a como configurar um servidor de log básico utilizando a ferramenta Rsyslog e introduzir um pouco sobre Facilidade e Nível. Essa será uma série de artigos, sendo este o primeiro. Os demais, serão mais específicos da ferramenta. Espero que gostem!" /> <link rel="canonical" href="https://stephan-lopes.github.io/blog/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/" /> <meta property="og:url" content="https://stephan-lopes.github.io/blog/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/" /> <meta property="og:site_name" content="K." /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-10-05T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Rsyslog #01: Configurando um Servidor de Log Básico" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"keven"},"dateModified":"2021-10-05T00:00:00+00:00","datePublished":"2021-10-05T00:00:00+00:00","description":"Tive a oportunidade de trabalhar com Rsyslog por um bom tempo, auxiliando na centralização dos logs de servidores. Isso me permitiu ver a necessidade de termos logs centralizado, bem como o quão importante eles são para um sistema. Neste artigo, tenho como objetivo ensinar a como configurar um servidor de log básico utilizando a ferramenta Rsyslog e introduzir um pouco sobre Facilidade e Nível. Essa será uma série de artigos, sendo este o primeiro. Os demais, serão mais específicos da ferramenta. Espero que gostem!","headline":"Rsyslog #01: Configurando um Servidor de Log Básico","mainEntityOfPage":{"@type":"WebPage","@id":"https://stephan-lopes.github.io/blog/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/"},"url":"https://stephan-lopes.github.io/blog/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/"}</script> <!-- End Jekyll SEO tag --> <!-- <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-57x57.png" /> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-114x114.png" /> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-72x72.png" /> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-144x144.png" /> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-60x60.png" /> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-120x120.png" /> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-76x76.png" /> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://stephan-lopes.github.io/assets/images/favicon/apple-touch-icon-152x152.png" /> <link rel="icon" type="image/png" href="https://stephan-lopes.github.io/assets/images/favicon/favicon-196x196.png" sizes="196x196" /> <link rel="icon" type="image/png" href="https://stephan-lopes.github.io/assets/images/favicon/favicon-96x96.png" sizes="96x96" /> <link rel="icon" type="image/png" href="https://stephan-lopes.github.io/assets/images/favicon/favicon-32x32.png" sizes="32x32" /> <link rel="icon" type="image/png" href="https://stephan-lopes.github.io/assets/images/favicon/favicon-16x16.png" sizes="16x16" /> <link rel="icon" type="image/png" href="https://stephan-lopes.github.io/assets/images/favicon/favicon-128.png" sizes="128x128" /> <meta name="application-name" content="&nbsp;"/> <meta name="msapplication-TileColor" content="#FFFFFF" /> <meta name="msapplication-TileImage" content="mstile-144x144.png" /> <meta name="msapplication-square70x70logo" content="mstile-70x70.png" /> <meta name="msapplication-square150x150logo" content="mstile-150x150.png" /> <meta name="msapplication-wide310x150logo" content="mstile-310x150.png" /> <meta name="msapplication-square310x310logo" content="mstile-310x310.png" /> --> <link rel="shortcut icon" href="https://stephan-lopes.github.io/assets/images/favicon/skull.svg" type="image/x-icon"> <link rel="canonical" href="https://stephan-lopes.github.io/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/"> <link rel="alternate" type="application/rss+xml" title="K." href="https://stephan-lopes.github.io/feed.xml" /> <script src="https://kit.fontawesome.com/d9b09040a7.js" crossorigin="anonymous"></script> <style> /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.highlight .hll{background-color:#272822}.highlight .c{color:#75715e}.highlight .err{color:#960050;background-color:#1e0010}.highlight .k{color:#66d9ef}.highlight .l{color:#ae81ff}.highlight .n{color:#f8f8f2}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .cm{color:#75715e}.highlight .cp{color:#75715e}.highlight .c1{color:#75715e}.highlight .cs{color:#75715e}.highlight .ge{font-style:italic}.highlight .gs{font-weight:bold}.highlight .kc{color:#66d9ef}.highlight .kd{color:#66d9ef}.highlight .kn{color:#f92672}.highlight .kp{color:#66d9ef}.highlight .kr{color:#66d9ef}.highlight .kt{color:#66d9ef}.highlight .ld{color:#e6db74}.highlight .m{color:#ae81ff}.highlight .s{color:#e6db74}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#a6e22e}.highlight .no{color:#66d9ef}.highlight .nd{color:#a6e22e}.highlight .ni{color:#f8f8f2}.highlight .ne{color:#a6e22e}.highlight .nf{color:#a6e22e}.highlight .nl{color:#f8f8f2}.highlight .nn{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f92672}.highlight .w{color:#f8f8f2}.highlight .mf{color:#ae81ff}.highlight .mh{color:#ae81ff}.highlight .mi{color:#ae81ff}.highlight .mo{color:#ae81ff}.highlight .sb{color:#e6db74}.highlight .sc{color:#e6db74}.highlight .sd{color:#e6db74}.highlight .s2{color:#e6db74}.highlight .se{color:#ae81ff}.highlight .sh{color:#e6db74}.highlight .si{color:#e6db74}.highlight .sx{color:#e6db74}.highlight .sr{color:#e6db74}.highlight .s1{color:#e6db74}.highlight .ss{color:#e6db74}.highlight .bp{color:#f8f8f2}.highlight .vc{color:#f8f8f2}.highlight .vg{color:#f8f8f2}.highlight .vi{color:#f8f8f2}.highlight .il{color:#ae81ff}.highlight .gu{color:#75715e}.highlight .gd{color:#f92672}.highlight .gi{color:#a6e22e}body,html{font-size:62.5%}body{font:16px "Helvetica Neue",Helvetica,Arial,sans-serif;color:#aaa;background:#000}h1,h2,h3,h4{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;color:#ededed;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}h1{font-size:3rem;letter-spacing:-1px;color:#ededed;font-weight:700}h2{font-size:2.2rem}h3{font-size:2rem}h4{font-size:1.6rem}a{color:#9300ff;text-decoration:underline;font-weight:400}p{line-height:1.7;color:#aaa;font-weight:300;margin-bottom:20px;letter-spacing:.4px}@media only screen and (max-width: 400px){p{letter-spacing:.2px}}strong{font-weight:400;color:#fff}ul li,ol li{line-height:2.4rem;font-weight:300;color:#aaa}img,pre,iframe{max-width:100%}img,pre{border-radius:4px}figcaption{position:relative;top:-20px;left:0;right:0;margin:0 auto;width:100%;text-align:center;font-size:1.3rem;color:#666;font-weight:300}@media only screen and (max-width: 400px){figcaption{font-size:1.2rem}}blockquote{padding-left:15px;border-left:3px solid #eee}hr{border:none;height:1px;margin:40px auto;background:#eee;width:100%}figure.highlight{width:100%;margin:0}code{padding:2px 3px;font-family:"Consolas",Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:middle;background:#eee;border-radius:2px}pre>code,tt{padding:1px 0;font-family:"Consolas",Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;background:#000;border-radius:2px}pre{box-sizing:border-box;margin:0 0 1.75em 0;width:100%;padding:5px 10px;font-family:"Consolas",Liberation Mono,Menlo,Courier,monospace;font-size:1.2rem;line-height:2rem;overflow:auto;background:#000;border:1px solid #222;border-radius:2px}.wrapper-normal,.wrapper-large{height:100%;width:96%;margin:0 auto}@media only screen and (max-width: 400px){.wrapper-normal,.wrapper-large{width:88%}}@media only screen and (min-width: 400px) and (max-width: 1050px){.wrapper-normal,.wrapper-large{width:88%}}.wrapper-normal{max-width:560px}.wrapper-large{max-width:810px}.text-center{text-align:center}.clearfix:before,.clearfix:after{content:"";display:table}.clearfix:after{clear:both}.animated{animation:fade-in-down .6s;animation-delay:.3s;animation-fill-mode:both}@keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px)}100%{opacity:1;transform:translateY(0)}}.home,.blog,.projects{margin-top:125px}.home>.list,.blog>.list,.projects>.list{border-top:1px solid #222;margin-top:30px;padding-top:40px;position:relative}.home>.list:before,.blog>.list:before,.projects>.list:before{display:block;content:" ";width:7px;height:7px;border:#222 1px solid;position:absolute;top:-5px;left:50%;margin-left:-5px;background:#000;box-shadow:#000 0 0 0 5px;border-radius:3px}.home>.list>.item,.blog>.list>.item,.projects>.list>.item{display:block;width:95%;margin:0 auto}.home>.list>.item>.url,.blog>.list>.item>.url,.projects>.list>.item>.url{width:100%;display:block;padding:20px 0;text-decoration:none}.home>.list>.item>.url>.title,.blog>.list>.item>.url>.title,.projects>.list>.item>.url>.title{margin:0;width:75%;font-weight:500;transition:all ease-in-out .2s}.home>.list>.item:hover>.url>.title,.blog>.list>.item:hover>.url>.title,.projects>.list>.item:hover>.url>.title{color:#9300ff}.home>.list aside,.blog>.list aside,.projects>.list aside{position:relative;top:2px;margin:0;width:25%;float:right;font-weight:300;color:#666;text-align:right;transition:all ease-in-out .2s}.home>.list .item:hover .url aside,.blog>.list .item:hover .url aside,.projects>.list .item:hover .url aside{color:#aaa}.blog>.list>.item>.url>.title,.projects>.list>.item>.url>.title{display:inline}.blog>.list>.item>.url>.emoji,.projects>.list>.item>.url>.emoji{display:inline;position:relative;top:-4px;margin-right:10px}.page{margin-top:125px}.page>h1{text-align:center;margin-bottom:6rem}.about img{width:50%;margin:0 auto;display:block}.post{margin-top:125px}.post>.title{text-align:center;margin-bottom:3rem}.post>.date,.post>.post-tags{color:#666;font-weight:400;font-size:1.4rem;text-transform:uppercase;text-align:center;display:block;margin-bottom:6rem;letter-spacing:1px;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility}.post>.date{margin-bottom:2rem}.post>.post-tags>.item{padding:2px 8px;border-radius:3px;font-size:1.1rem;background:#222;color:#aaa;letter-spacing:1px;margin:3px 1px;text-decoration:none;display:inline-block}.post>h2,.post>h3,.post>h4{margin-top:40px}.post>h2 a,.post>h3 a,.post>h4 a{text-decoration:none}.post>.title-image{max-height:120px;display:block;margin:0 auto}.post>.blog-navigation{font-size:1.4rem;display:block;width:auto;overflow:hidden}.post>.blog-navigation a{display:block;width:50%;float:left;margin:1em 0}.post>.blog-navigation .next{text-align:right}.tags{margin-top:125px}.tags>.list{border-top:1px solid #222;margin-top:30px;padding-top:40px;position:relative}.tags>.list:before{display:block;content:" ";width:7px;height:7px;border:#222 1px solid;position:absolute;top:-5px;left:50%;margin-left:-5px;background:#000;box-shadow:#000 0 0 0 5px;border-radius:3px}.tags>.list>.item{font-weight:300;text-transform:uppercase;text-align:center;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;padding:3px 9px;border-radius:3px;font-size:1.3rem;background:#222;color:#aaa;letter-spacing:1px;margin:0 .5rem 1rem;text-decoration:none;display:inline-block}.tag-list>.list{padding:0}.tag-list>.list>.item{display:block;width:80%;margin:0 10%}.tag-list>.list>.item>.url{width:100%;height:100%;display:block;padding:20px 0;text-decoration:none}.tag-list>.list>.item>.url>.title{margin:0;width:75%;font-weight:400;transition:all ease-in-out .2s;font-size:1.6rem}.tag-list>.list>.item:hover>.url>.title{color:#9300ff}.tag-list>.list aside{position:relative;top:2px;margin:0;width:25%;float:right;font-weight:300;color:#666;text-align:right;transition:all ease-in-out .2s;font-size:1.6rem}.tag-list>.list .item:hover .url aside{color:#aaa}.author{padding:3rem 0;border-bottom:1px solid #222;border-top:1px solid #222;max-width:100%;margin:4rem auto 0}.author>.toleft>.selfie{width:90%;border-radius:100%}.author>.toright>.name,.author>.toright>.bio{width:60%;display:inline-block}.author>.toright>.name{font-size:1.5rem;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:500;margin:6px 0 0}@media only screen and (max-width: 400px){.author>.toright>.name{width:100%;display:block}}@media only screen and (min-width: 400px) and (max-width: 1050px){.author>.toright>.name{width:100%;display:block}}.author>.toright>.bio{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;color:#666;font-size:1.3rem;text-align:justify;line-height:1.5;margin:0}@media only screen and (max-width: 400px){.author>.toright>.bio{width:100%;display:block}}@media only screen and (min-width: 400px) and (max-width: 1050px){.author>.toright>.bio{width:100%;display:block}}.author>.toleft{width:10%;display:inline-block}@media only screen and (max-width: 400px){.author>.toleft{width:20%}}@media only screen and (min-width: 400px) and (max-width: 1050px){.author>.toleft{width:20%}}.author>.toright{width:89%;display:inline-block;vertical-align:top}@media only screen and (max-width: 400px){.author>.toright{width:78%}}@media only screen and (min-width: 400px) and (max-width: 1050px){.author>.toright{width:78%}}.no-disqus{border-bottom:none;padding-bottom:0}.disqus{margin:0 auto;max-width:100%;padding:40px 0}.footer-main{border-top:1px solid #222;padding:40px 0;margin:40px 0 0;font-size:1.3rem;color:#666;font-weight:400;text-align:center;position:relative}.footer-main:before{display:block;content:" ";width:7px;height:7px;border:#222 1px solid;position:absolute;top:-5px;left:50%;margin-left:-5px;background:#000;box-shadow:#000 0 0 0 5px;border-radius:3px}.footer-main>.copyright{padding-left:10px}.footer-main>.link{display:inline;vertical-align:middle}.footer-main>.link>.icon{width:15px !important;fill:#666 !important;transition:ease-in-out all .3s;position:relative;display:inherit;top:-2px;margin:0;left:2px}.footer-main>.link>.icon:hover{fill:#9300ff !important}.footer-main>.extra{color:#666;margin-top:0;font-weight:400}.footer-main>.extra>.link{color:#ededed;text-decoration:none;border-bottom:1px solid transparent;transition:ease-in-out all .3s;padding-bottom:1px;font-weight:300}.footer-main>.extra>.link:hover{border-color:#666}.header-home{display:block;margin:0 auto;text-align:center;position:relative;z-index:99}.header-home>.link>.selfie{width:125px;height:125px;margin-bottom:25px;border-radius:100%;transition:all .2s;opacity:1}.header-home>.link>.selfie:hover{box-shadow:0 0px 4px 0 rgba(0,0,0,0.18),0 0px 12px 0 rgba(0,0,0,0.15);opacity:.8}.header-home>.title{font-size:4rem;margin:0 0 13px}.header-home>.description{font-size:1.85rem;font-weight:400;font-style:normal;color:#666;width:70%;margin:0 auto 30px}.header-home>.description a{font-weight:200}.nav>.list,.nav-home>.list{list-style:none;margin:0;padding:0 13px 0}.nav>.list>.item,.nav-home>.list>.item{display:inline-block}.nav>.list>.item>.link,.nav-home>.list>.item>.link{display:inline-block;font-weight:400;font-size:1.4rem;padding:20px 10px;text-decoration:none}.nav{position:absolute;right:0;top:0}.nav>.list{padding:0 13px 0}.nav>.list>.item>.link{font-size:1.4rem;padding:20px 10px}.nav-home{margin-top:40px;text-align:center}.nav-home>.list{padding:0}.nav-home>.list>.item>.link{font-size:2rem;padding:7px 15px;margin:0;border-radius:4%;transition:all .4s ease-in-out;width:70px}.nav-home>.list>.item>.link:hover{color:#aaa}.evidence{background-image:linear-gradient(to bottom, #1E2D24, #1E2D24);color:#ededed}.star>.url>.title{width:auto !important;display:inline;background-image:linear-gradient(#1E2D24, #1E2D24)}.twitter-tweet{margin:10px auto}.icon{display:inline-block;width:17px;height:17px;fill:#fff;text-align:center;color:#666;margin:7px auto}.caption{position:relative;top:1rem;left:0;right:0;margin:0 auto;width:100%;text-align:center;font-size:1.3rem;font-weight:400}.bigger-image{min-width:130%;margin:5rem 0 5rem -15%}@media only screen and (max-width: 400px){.bigger-image{min-width:114%;margin:2rem 0 2rem -7%}}@media only screen and (min-width: 400px) and (max-width: 1050px){.bigger-image{min-width:114%;margin:2rem 0 2rem -7%}}.breaker{height:1px;margin:6rem auto;width:100%}.breaker:before{content:"• • •";width:100%;text-align:center;display:block;color:#666;letter-spacing:4px;position:relative;top:-8px}.lost-container{text-align:center}.pagination{width:95%;margin:3rem auto 0;text-align:center}.pagination>.page_number{display:inline-block;font-size:1.3rem}.pagination>.previous,.pagination>.next{display:inline-block;font-size:1.8rem;position:relative;top:1px;padding:1px 9px}.pagination>.hidden{visibility:hidden}.related{margin:10rem 0 0rem}.related a{font-weight:400}.share{float:right;width:40%;display:inline;text-align:right;position:relative}@media only screen and (max-width: 400px){.share{width:100%;display:block;top:0;text-align:left;float:none;margin-top:5px}}@media only screen and (min-width: 400px) and (max-width: 1050px){.share{width:100%;display:block;top:0;text-align:left;float:none;margin-top:5px}}.share>.twitter,.share>.facebook,.share>.linkedin{display:inline;vertical-align:middle;font-size:13px;font-weight:700;color:#fff;padding:6px 10px;border-radius:3px;margin-left:5px;text-decoration:none}@media only screen and (max-width: 400px){.share>.twitter,.share>.facebook,.share>.linkedin{margin:0 5px 10px 0}}@media only screen and (min-width: 400px) and (max-width: 1050px){.share>.twitter,.share>.facebook,.share>.linkedin{margin:0 5px 10px 0}}.share>.twitter{background:#4fafed}.share>.facebook{background:#4361b3}.share>.linkedin{background:#0077b5}.share svg{fill:#000;position:relative;top:0;margin:0;margin-right:4px;display:inherit}@media only screen and (min-width: 780px){.side-by-side{width:130%;margin:6rem 0 6rem -15%}}@media only screen and (max-width: 780px){.side-by-side{width:100%;margin:4rem 0}}.side-by-side>.toleft,.side-by-side>.toright{display:inline-block;width:47.5%}@media only screen and (max-width: 780px){.side-by-side>.toleft img,.side-by-side>.toright img{text-align:center;display:block;margin:0 auto}}@media only screen and (min-width: 780px){.side-by-side>.toleft{margin-right:2%}}@media only screen and (max-width: 780px){.side-by-side>.toleft{width:100%;margin:0 0 4rem 0}}@media only screen and (min-width: 780px){.side-by-side>.toright{margin-left:2%;vertical-align:top}}@media only screen and (max-width: 780px){.side-by-side>.toright{width:100%;margin:0 0 4rem 0}}.side-by-side>.toleft>p,.side-by-side>.toright>p{margin:0 0 4rem 0}@media only screen and (max-width: 780px){.side-by-side>.toleft>p,.side-by-side>.toright>p{margin:0}}.social-links>.link{margin:0;text-decoration:none;position:relative;display:inline-block;height:35px;width:35px;color:#fff}.social-links>.link:hover>svg{color:#9300ff}.social-links>svg{transition:all ease-in-out .2s}.spoiler{position:relative}.spoiler:before{content:"";background-color:#fafae0;position:absolute;top:0;bottom:0;left:0;right:0;z-index:50}.spoiler:hover:before{display:none} </style> </head> <body> <div class="wrapper-large"> <div class="post"> <nav class="nav"> <ul class="list"> <li class="item"> <a class="link" href="https://stephan-lopes.github.io/">Home</a> </li> <li class="item"> <a class="link" href="https://stephan-lopes.github.io/blog">Blog</a> </li> <li class="item"> <a class="link" href="https://stephan-lopes.github.io/projects">Projects</a> </li> <li class="item"> <a class="link" href="https://stephan-lopes.github.io/about">About</a> </li> </ul> </nav> <h1 class="title">Rsyslog #01: Configurando um Servidor de Log Básico</h1> <span class="date"> <time datetime="05-10-2021">Tuesday. October 05, 2021</time> - <span class="reading-time" title="Estimated read time"> 10 mins </span> </span> <div class="post-tags"> <a class="item" href="https://stephan-lopes.github.io/tags/#rsyslog">rsyslog</a> <a class="item" href="https://stephan-lopes.github.io/tags/#linux">linux</a> <a class="item" href="https://stephan-lopes.github.io/tags/#log">log</a> </div> <p><em>As mensagens em uma rede de computadores podem ser centralizadas em um único servidor. Quando centralizadas, fica mais fácil o gerenciamento, análise e solução de problemas relacionados as máquinas presentes nesta rede. O artigo a seguir, tem como objetivo ensinar a como configurar um servidor de log básico utilizando essa ferramenta, e introduzir ao leitor conceitos de Facilidade e Nível.</em></p> <h2 id="_-o-que-é-um-servidor-de-log">&gt;_ O que é um servidor de Log?</h2> <p>Basicamente, um servidor de log, seria uma máquina que centraliza todas as mensagens de algumas máquinas em uma rede, para que sejam armazenadas, e posteriormente, com outras ferramentas, analisadas. A necessidade de um servidor centralizado de Log, é essencial, quando temos mais de um (diria 2 ou mais) servidores. Além de manter os dados em um outro servidor, garantindo assim uma certa dificuldade de alterá-los caso haja um incidente de segurança da informação, ele também permite a centralização dos logs de diversos servidores, que poderão ser analisados em um único local.</p> <p>Imagine você tendo que cuidar de mais de 500 servidores… Ficaria difícil, em algumas situações, identificar algum problema, sem um servidor de log centralizado, não é mesmo?</p> <h2 id="_-qual-servidor-de-log-devo-utilizar">&gt;_ Qual servidor de Log devo utilizar?</h2> <p>Existem inúmeras alternativas no mercado, como por exemplo syslog-ng, rsyslog, logstash, e até mesmo, se formos pra nuvem, o CloudWatch da AWS, dentre outros. Neste artigo, meu foco será introduzi-lo ao Rsyslog. Entretanto, nada impede que você, leitor, utilize outra ferramenta. Apenas devo informar que, provavelmente, o artigo não servirá para a ferramenta escolhida, caso a ferramenta escolhida seja diferente.</p> <h2 id="_-considerações">&gt;_ Considerações</h2> <p>Como forma de melhorar o entendimento, estarei disponibilizando um arquivo Vagrantfile no fim do artigo que possibilitará a criação de um ambiente de estudo. Os requisitos para o artigo, no entanto, serão apenas duas máquinas, sendo uma que servirá de <strong>Cliente</strong> e outra como <strong>Servidor</strong>. Utilizarei Centos/7 em ambas as duas, por familiaridade. Caso tenha uma familiaridade com outra distribuição Linux, fique a vontade de utilizá-la. Não serão utilizadas máquinas Windows.</p> <p>Com essas considerações, vamos a mão na massa!</p> <h2 id="_-criando-o-ambiente-de-estudo">&gt;_ Criando o ambiente de estudo</h2> <p>Caso tenha optado por utilizar o arquivo Vagrantfile, fornecido no artigo para criar seu ambiente de estudo, apenas execute o comando abaixo para criar o ambiente:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">vagrant up</code></pre></figure> <p>O processo de criação demora um certo tempo, até que todas as máquinas sejam criadas. Após a criação, para acessar as máquinas, execute os comandos abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">vagrant ssh server <span class="c"># ---&gt; Entra na máquina do servidor</span>
vagrant ssh client <span class="c"># ---&gt; Entra na máquina do cliente</span></code></pre></figure> <h2 id="_-instalando-o-rsyslog">&gt;_ Instalando o Rsyslog</h2> <p>Por padrão, as máquinas Centos/7 já possuem o Rsyslog instalado. Entretanto, ele é de algumas versões anteriores do mesmo. Para ver a versão do Rsyslog na máquina <strong>Cliente</strong> e <strong>Servidor</strong>, utilize o comando abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">rsyslogd <span class="nt">-v</span></code></pre></figure> <p><img src="https://stephan-lopes.github.io/assets/images/rsyslog-01-configurando-um-servidor-de-log-básico/1628350418210.png" alt="Imagem" /></p> <p>A versão mais recente do Rsyslog, no momento que escrevo este artigo, é a 8.2106.0. Olhando no site do Rsyslog, notamos que a versão 8.24, é de outubro de 2017. Em um próximo artigo será introduzida a linguagem RainerScript, por isso é necessário que uma versão mais atualizada esteja presente, evitando assim, possíveis problemas de incompatibilidade com a linguagem.</p> <p>Vamos então incluir o repositório oficial do Rsyslog, para conseguir um binário pré-compilado atualizado. Para isso, basta executar os seguintes comandos abaixo com o usuário <strong>root</strong> em ambas as máquinas (<strong>Servidor</strong> e <strong>Cliente</strong>):</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">cd</span> /etc/yum.repos.d/
wget http://rpms.adiscon.com/v8-stable/rsyslog.repo
yum <span class="nb">install </span>rsyslog <span class="nt">-y</span></code></pre></figure> <p>Após a execução dos comandos, teremos a versão mais atualizada do Rsyslog (versão estável)</p> <p><img src="https://stephan-lopes.github.io/assets/images/rsyslog-01-configurando-um-servidor-de-log-básico/1628352331901.png" alt="Imagem" /></p> <h2 id="_-subindo-servidor-rsyslog-legado">&gt;_ Subindo servidor Rsyslog (legado)</h2> <p>Com a versão mais recente do programa instalada, podemos agora criar o nosso <strong>Servidor</strong>. É possível criar um <strong>Servidor</strong> rsyslog de forma muito simples, entretanto, legada. Ela utiliza a forma anterior ao qual o Rsyslog trabalhava seus arquivos de configuração. O arquivo de configuração padrão do Rsyslog, é o arquivo presente em <em>/etc/rsyslog.conf</em>.</p> <p>No diretório <em>/etc/rsyslog.d/</em> ficam os arquivos que são importados pelo rsyslog. Nele que você pode configurar regras personalizadas. Uma boa prática, é criar seus <em>rulesets</em> personalizados neste diretório, ao invés de criar no arquivo <em>rsyslog.conf</em>.</p> <p>Vamos configurar primeiramente nosso <strong>Servidor</strong>. Pra isso, iremos remover o comentário das seguintes linhas:</p> <p><img src="https://stephan-lopes.github.io/assets/images/rsyslog-01-configurando-um-servidor-de-log-básico/1628385769857.png" alt="Imagem" /></p> <p>Salve o arquivo, e execute o comando abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">systemctl restart rsyslogd</code></pre></figure> <p>Isso fará com que o Servidor seja reiniciado, e com isso, carregue o arquivo de configuração novamente. Dessa forma, ele saberá que deve escutar na porta 514 - como define a linha onde está presente $UDPServerRun 514 - e que deve ser pelo protocolo UDP.</p> <p>Certo. Mas será que ele está funcionando? Será que está recebendo log? Bom, precisamos sabermos isso. Primeiramente, vamos verificar se o <strong>Servidor</strong> está funcionando corretamente. Digite em seu terminal:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">systemctl status rsyslogd</code></pre></figure> <p>Está com status ativo? Está rodando? Ótimo. Já sabemos que o Servidor está sendo executado. Agora precisamos verificar se a porta no protocolo UDP está realmente aberta, executando o comando abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">netstat <span class="nt">-lnup</span> | <span class="nb">grep </span>514</code></pre></figure> <p>Apareceu algum resultado? Se apareceu um resultado, temos agora um <strong>Servidor</strong> de Logs configurado.</p> <p>Mas, calma aí… Não temos a certeza ainda que está funcionando. Isso porque o <strong>Servidor</strong> ainda não está coletando arquivo de logs de outros lugares, apenas dele mesmo. Precisamos configurar agora a máquina <strong>Cliente</strong>, para enviar logs para o servidor.</p> <p><em>PS:. Antes de deixarmos o <strong>Servidor</strong> de lado por um momento, e configurarmos a máquina <strong>Cliente</strong>, execute o comando abaixo, e anote o endereço IP da máquina <strong>Servidor</strong>:</em></p> <p><img src="https://stephan-lopes.github.io/assets/images/rsyslog-01-configurando-um-servidor-de-log-básico/1628909014687.png" alt="Imagem" /></p> <p><em>Mais tarde, enquanto estivermos configurando a máquina <strong>Cliente</strong>, precisaremos especificar para onde estaremos enviando os logs, e iremos informar que será para este endereço IP.</em></p> <h2 id="_-configurando-cliente-rsyslog-legado">&gt;_ Configurando cliente Rsyslog (Legado)</h2> <p>Com o <strong>Servidor</strong> já configurado, vamos então para a máquina <strong>Cliente</strong>. Acesse ela em outra aba do terminal, e abra o arquivo de configuração em <em>/etc/rsyslog</em>.conf. No fim do arquivo, adicione a seguinte linha de código:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="k">*</span>.<span class="k">*</span> @&lt;ENDEREÇO_IP&gt;</code></pre></figure> <p>PS:. Substitua o <ENDEREÇO_IP>, pelo endereço IP do Servidor ao qual você anotou no passo anterior.</ENDEREÇO_IP></p> <h2 id="_-testando-configuração-de-comunicação-cliente-servidor">&gt;_ Testando configuração de comunicação Cliente-Servidor</h2> <p>Precisamos testar agora se o <strong>Cliente</strong> está enviando os logs para o <strong>Servidor</strong> centralizado. Salve o arquivo, e saia dele, caso ainda não tenha feito. O próximo passo é reiniciar o serviço rsyslog da máquina <strong>Cliente</strong>, utilizando o mesmo comando que usamos anteriormente para reiniciar o serviço na máquina <strong>Servidor</strong>:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">systemctl restart rsyslogd</code></pre></figure> <p>Reiniciou? Vamos verificar se o serviço está funcionando, executando o comando abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">systemctl status rsyslogd</code></pre></figure> <p>Está ativo? Se estiver, então a nova linha que adicionamos no arquivo de configuração do Rsyslog foi carregada pelo serviço. Os últimos passos, para verificar se o <strong>Servidor</strong> está funcionando seriam: executar um comando para ler um dos arquivo de log, neste caso, o <em>/var/log/messages</em>, e também, gerarmos um log de exemplo na máquina <strong>Cliente</strong>, para verificar se está sendo enviado para o <strong>Servidor</strong>.</p> <p>Execute o comando abaixo no <strong>Servidor</strong>:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">tail</span> <span class="nt">-f</span> <span class="nt">-n1</span> /etc/messages</code></pre></figure> <p>Esse comando está mostrando de forma iterativa no terminal, toda novidade que for registrada no arquivo /etc/messages, dentro do <strong>Servidor</strong>.</p> <p>Na máquina <strong>Cliente</strong>, execute o comando abaixo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">logger <span class="nt">-p</span> info Mensagem de teste</code></pre></figure> <p>Com esse comando, enviamos um log de teste para o serviço do Rsyslog, que irá salvar em algum dos arquivos ao qual nele foi dito para salvar. No nosso caso, ele irá enviar também para a máquina <strong>Servidor</strong>, como definimos adicionando aquela linha, no arquivo de configuração.</p> <p>Volte agora para a máquina <strong>Servidor</strong> e verifique se chegou alguma mensagem, como a mensagem abaixo. Se chegou, então a máquina <strong>Servidor</strong> e a máquina <strong>Cliente</strong> estão conseguindo se comunicar corretamente.</p> <p><img src="https://stephan-lopes.github.io/assets/images/rsyslog-01-configurando-um-servidor-de-log-básico/1629071777012.png" alt="Imagem" /></p> <h2 id="_-entendendo-configuração-da-máquina-cliente-e-servidor">&gt;_ Entendendo configuração da máquina Cliente e Servidor</h2> <h3 id="servidor">Servidor</h3> <p>Na máquina <strong>Servidor</strong>, descometamos a linha que permitia com que fosse possível o recebimento de arquivos de log via rede. Nós abrimos a porta 514 do protocolo UDP, para que a velocidade de entrega do log fosse maior. Entretanto, com isso, podemos perder alguns logs, já que não existe o <em>three handshake</em> presente no protocolo TCP. Aconselho utilizar o protocolo UDP apenas para quando você prioriza mais a velocidade de entrega, do que ter a garantia de recebimento da mensagem. Caso queira garantir a entrega da mensagem de log, use o TCP.</p> <p>O TCP, apesar de garantir a entrega, acaba sendo mais lento. E no caso de queda do <strong>Servidor de logs</strong>, ele vai tentar garantir o envio da mensagem ao destino mesmo assim. Então ele vai ficar tentando enviar a mensagem, e tentando, e tentando… e tentando…</p> <p>É possível também utilizar certificados TLS, junto com o protocolo TCP, o que permite com que sua mensagem não seja lida por terceiros, caso seja interceptada antes de chegar no <strong>Servidor</strong>. Entretanto, isso faz com que a velocidade acabe sendo mais prejudicada.</p> <p>Uma alternativa para garantir a entrega da mensagem ao <strong>Servidor</strong>, uma velocidade maior que o módulo do <em>imtcp</em>, e também caso não necessite de um certificado TLS, é a utilização do módulo <em>imptcp</em>. Ele é mais simples que o módulo <em>imtcp</em>, mas não permite a criptografia por ele, tendo que ser realizada pelo software <em>stunnel</em> caso necessite. Neste último caso, em específico, utilize o <em>imtcp</em>.</p> <h3 id="cliente">Cliente</h3> <p>Na máquina <strong>Cliente</strong>, definimos qual seria o protocolo utilizado colocando apenas um “@” na frente do endereço IP do <strong>Servidor</strong> no arquivo de configuração. Isso definiu o protocolo de envio como UDP. Caso desejássemos utilizar o protocolo TCP, seriam dois “@” seguidos do endereço IP.</p> <p>O <em>.</em>, definiu a facilidade e nível do log, em cada “*”, respectivamente. Isso diz que todos os logs de todos os níveis e facilidades são enviados ao <strong>Servidor de log</strong>. Poderíamos limitar que tipo de log seria enviado ao <strong>Servidor de log</strong>, através da facilidade, fazendo o seguinte, por exemplo:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">kern.<span class="k">*</span>  @&lt;IP-DO-SERVIDOR&gt;</code></pre></figure> <p>Agora, apenas os logs do kernel serão enviados para o <strong>Servidor</strong>.</p> <p>Se quisermos, podemos também definir apenas um nível mais severo de log do kernel, para apenas logs de erros, ou mais críticos que isso, sejam enviados ao <strong>Servidor</strong>:</p> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">kern.err  @&lt;IP-DO-SERVIDOR&gt; </code></pre></figure> <p>Agora, você receberá apenas logs de erro mais severos, como Error, Critical, Alert, e Emergency.</p> <h2 id="_-conclusão">&gt;_ Conclusão</h2> <p>Esse primeiro artigo sobre o Rsyslog, mostrou de uma forma simples, como criar um servidor de log centralizado. Entretanto, há muita coisa que podemos melhorar. Nos próximos artigos, irei me aprofundar mais no seu funcionamento, tipos de módulos existentes, entre outras análises, que em um artigo só, fica difícil escrever.</p> <p>Gostou do artigo, tem alguma dúvida ou possui alguma sugestão para os próximos? Por favor, comente! Feedbacks me auxiliam a melhorar o conteúdo por aqui.</p> <hr /> <h2 id="links">Links</h2> <ul> <li>Vagrantfile: <a href="https://gist.github.com/stephan-lopes/3213f88f44094ed8f25d5bfc328c9a5a">GitHub</a></li> <li>Rsyslog Facilities and Levels: <a href="https://wiki.archlinux.org/title/rsyslog">GitHub</a></li> </ul> <div class="breaker"></div> <div class="blog-navigation"> <a class="prev" href="https://stephan-lopes.github.io/camuflando-endere%C3%A7o-ip-em-testes-de-seguran%C3%A7a/">&laquo; Camuflando Endereço IP em Testes de Segurança</a> <a class="next" href="https://stephan-lopes.github.io/guia-rapido-wsl-virtualbox/">Guia Rápido: WSL + Virtualbox &raquo;</a> </div> <div class="related"> <h4>Related Posts</h4> <ul> <li class="relatedPost"> <a href="https://stephan-lopes.github.io/comandos-linux-exec/">Comandos Linux: Exec </a> </li> <li class="relatedPost"> <a href="https://stephan-lopes.github.io/comandos-linux-alias/">Comandos Linux: Alias </a> </li> <li class="relatedPost"> <a href="https://stephan-lopes.github.io/comandos-linux-variaveis-de-ambiente/">Comandos Linux: Variáveis de Ambiente </a> </li> <li class="relatedPost"> <a href="https://stephan-lopes.github.io/comandos-linux-a-linha-de-comando/">Comandos Linux: A linha de Comando </a> </li> </ul> </div> <section class="author"> <div class="toleft"> <img class="selfie" src="https://stephan-lopes.github.io/assets/images/profile-pic.png" alt="Keven S. Lopes" /> </div> <div class="toright"> <h4 class="name">Keven S. Lopes</h4> <p class="bio">Só mais um garoto de TI, querendo aprender, e compartilhar conhecimento.</p> <div class="share"> <!-- Note: Only use three share links if your site width is set to large --> <!-- If site width is set to normal, you may choose any two share links --> <a class="twitter" href="https://twitter.com/intent/tweet?text=https://stephan-lopes.github.io/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/ - Rsyslog #01: Configurando um Servidor de Log Básico by @" > <i class="fa-brands fa-twitter"></i> <span class="icon-twitter">Tweet</span> </a> <a class="facebook" href="javascript:void(0)" onclick="window.open('https://facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 'facebook-share-dialog', 'width=626,height=436'); return false;" > <i class="fa-brands fa-facebook"></i> <span class="icon-facebook-rect">Share</span> </a> <!-- <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://stephan-lopes.github.io/rsyslog-01-configurando-um-servidor-de-log-b%C3%A1sico/&amp;title=Rsyslog #01: Configurando um Servidor de Log Básico&amp;summary=Tive a oportunidade de trabalhar com Rsyslog por um bom tempo, auxiliando na centralização dos logs de servidores. Isso me permitiu ver a necessidade de termos logs centralizado, bem como o quão importante eles são para um sistema. Neste artigo, tenho como objetivo ensinar a como configurar um servidor de log básico utilizando a ferramenta Rsyslog e introduzir um pouco sobre Facilidade e Nível. Essa será uma série de artigos, sendo este o primeiro. Os demais, serão mais específicos da ferramenta. Espero que gostem!&amp;source=https://stephan-lopes.github.io" target="_blank"> <i class="fa-brands fa-linkedin"></i> <span class="icon-linkedin">Share</span> </a> --> </div> </div> </section> <footer class="footer-main"> K. © 2022 <a class="link" href="https://stephan-lopes.github.io/feed.xml" target="_blank"> <svg class="icon icon-rss"> <use xlink:href="#icon-rss"></use> </svg> </a> <p class="extra"> <a class="link" href="https://github.com/sergiokopplin/indigo">Indigo theme</a> by <a class="link" href="https://github.com/sergiokopplin/indigo">Kopplin</a> </p> </footer> </div> </div> </div> </div> </body> </html>
